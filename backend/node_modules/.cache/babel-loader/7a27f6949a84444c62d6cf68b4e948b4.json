{"ast":null,"code":"import Dbal from \"../modele/dbal\";\nimport client from \"../metier/client\";\nexport default class DaoClient {\n  constructor() {\n    if (!!DaoClient.instance) {\n      return DaoClient.instance;\n    }\n\n    DaoClient.instance = this;\n    this.dbal = new Dbal();\n    return this;\n  }\n\n  async getAll() {\n    const liste = [];\n    const reponse = await this.dbal.get(\"/api/clients\");\n    const clients = JSON.parse(reponse);\n\n    for (const c of clients) {\n      liste.push(new client(c));\n    }\n\n    return liste;\n  }\n\n  async getById(id) {\n    const url = \"/api/clients/\" + id;\n    response = await d.get(url);\n    client = JSON.parse(response);\n  }\n\n  async load(c) {\n    let reponse = await this.dbal.get(c.ville);\n    c.ville = JSON.parse(reponse).nom;\n    reponse = await this.dbal.get(\"/api/client/soldeById/\" + c.id);\n    c.solde = JSON.parse(reponse);\n    return new client(c);\n  }\n\n  async archiver(client, valeur) {\n    const url = \"/api/client/modifClient/\" + client.id + \"/,/,/,/,/,/\" + valeur;\n    return await this.dbal.put(url);\n  }\n\n  async modifier(client) {\n    const archive = !client.archive ? \"0\" : \"1\";\n    const mail = client.mail.replace(\".\", \",\");\n    const url = \"/api/client/modifClient/\" + client.id + \"/\" + client.nom + \"/\" + client.prenom + \"/\" + client.ville + \"/\" + client.tel + \"/\" + mail + \"/\" + archive;\n    return await this.dbal.put(url);\n  }\n\n  async creer(client) {\n    const mail = client.mail.replace(\".\", \",\");\n    const aujourdhui = this.dbal.date2amd(new Date());\n    const ville = client.ville;\n    let url = \"/api/client/addClient/\" + client.nom + \"/\" + client.prenom + \"/\" + ville + \"/\" + client.tel + \"/\" + mail + \"/0\";\n    let response = await d.post(url);\n    const lastId = JSON.parse(response);\n    url = \"http://localhost:8080/api/transaction/addTransaction/\" + aujourdhui + \"/0,00/Carte bancaire/ /Creation du compte/ /\" + client.id;\n    response = await d.post(url);\n    client = await this.loadClient(client);\n    this.setState({\n      client: client\n    });\n    this.props.onChange(client);\n\n    if (JSON.parse(response)) {\n      alert(\"Le joueur à bien été crée.\");\n    }\n  }\n\n}","map":{"version":3,"sources":["C:/wamp64/www/PPE2/DeuxiemeSituation/backend/src/modele/DaoClient.js"],"names":["Dbal","client","DaoClient","constructor","instance","dbal","getAll","liste","reponse","get","clients","JSON","parse","c","push","getById","id","url","response","d","load","ville","nom","solde","archiver","valeur","put","modifier","archive","mail","replace","prenom","tel","creer","aujourdhui","date2amd","Date","post","lastId","loadClient","setState","props","onChange","alert"],"mappings":"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","sourcesContent":["import Dbal from \"../modele/dbal\";\r\nimport client from \"../metier/client\";\r\n\r\nexport default class DaoClient {\r\n    constructor() {\r\n        if (!!DaoClient.instance) {\r\n            return DaoClient.instance;\r\n        }\r\n        DaoClient.instance = this;\r\n        this.dbal = new Dbal();\r\n        return this;\r\n    }\r\n\r\n    async getAll(){\r\n        const liste =  [];\r\n        const reponse = await this.dbal.get(\"/api/clients\");\r\n        const clients = JSON.parse(reponse);\r\n        for (const c of clients) {\r\n            liste.push(new client(c));\r\n        }\r\n        return liste;\r\n    }\r\n\r\n    async getById(id){\r\n        const url = \"/api/clients/\" + id;\r\n        response = await d.get(url);\r\n        client = JSON.parse(response);\r\n    }\r\n\r\n    async load(c){\r\n        let reponse = await this.dbal.get(c.ville);\r\n        c.ville = (JSON.parse(reponse)).nom;\r\n        reponse = await this.dbal.get(\"/api/client/soldeById/\" + c.id);\r\n        c.solde = JSON.parse(reponse);\r\n        return new client(c);\r\n    }\r\n\r\n    async archiver(client, valeur){\r\n        const url = \"/api/client/modifClient/\"+ client.id + \"/,/,/,/,/,/\" + valeur;\r\n        return await this.dbal.put(url);\r\n    }\r\n\r\n    async modifier(client){\r\n        const archive = (!client.archive)?\"0\":\"1\";\r\n        const mail = client.mail.replace(\".\", \",\");\r\n        const url = \"/api/client/modifClient/\"+ client.id + \"/\"\r\n            + client.nom + \"/\"\r\n            + client.prenom + \"/\"\r\n            + client.ville + \"/\"\r\n            + client.tel + \"/\"\r\n            + mail + \"/\"\r\n            + archive;\r\n        return await this.dbal.put(url);\r\n    }\r\n\r\n    async creer(client){\r\n        const mail = client.mail.replace(\".\", \",\");\r\n        const aujourdhui = this.dbal.date2amd(new Date());\r\n        const ville = client.ville;\r\n\r\n        let url = \"/api/client/addClient/\"\r\n            + client.nom + \"/\"\r\n            + client.prenom + \"/\"\r\n            + ville + \"/\"\r\n            + client.tel + \"/\"\r\n            + mail + \"/0\";\r\n        let response = await d.post(url);\r\n        const lastId = JSON.parse(response);\r\n\r\n\r\n        url = \"http://localhost:8080/api/transaction/addTransaction/\" + aujourdhui + \"/0,00/Carte bancaire/ /Creation du compte/ /\" + client.id;\r\n        response = await d.post(url);\r\n        client =  await this.loadClient(client);\r\n        this.setState({client: client});\r\n        this.props.onChange(client);\r\n        if(JSON.parse(response)){alert(\"Le joueur à bien été crée.\")}\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}