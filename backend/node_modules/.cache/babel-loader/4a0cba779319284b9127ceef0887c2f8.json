{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import Dbal from\"./Dbal\";import client from\"../metier/Client\";import DaoTransaction from\"./DaoTransaction\";import DaoUtilisateur from\"./DaoUtilisateur\";var DaoClient=/*#__PURE__*/function(){/**\r\n     * Singleon\r\n     * @returns {DaoClient|DaoClient}\r\n     */function DaoClient(){_classCallCheck(this,DaoClient);if(!!DaoClient.instance){return DaoClient.instance;}/**@type {DaoClient}**/DaoClient.instance=this;/**@type {Dbal}**/this.dbal=new Dbal();return this;}/**\r\n     * Récupère tous les clients\r\n     * @returns {Promise<[]>}\r\n     */_createClass(DaoClient,[{key:\"getAll\",value:function(){var _getAll=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var liste,reponse,clients,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,c;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:liste=[];_context.next=3;return this.dbal.get(\"/api/clients\");case 3:reponse=_context.sent;clients=JSON.parse(reponse);_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context.prev=8;for(_iterator=clients[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){c=_step.value;liste.push(new client(c));}_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](8);_didIteratorError=true;_iteratorError=_context.t0;case 16:_context.prev=16;_context.prev=17;if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return();}case 19:_context.prev=19;if(!_didIteratorError){_context.next=22;break;}throw _iteratorError;case 22:return _context.finish(19);case 23:return _context.finish(16);case 24:return _context.abrupt(\"return\",liste);case 25:case\"end\":return _context.stop();}}},_callee,this,[[8,12,16,24],[17,,19,23]]);}));function getAll(){return _getAll.apply(this,arguments);}return getAll;}()/**\r\n     * Récupère un client à partir de sn Id\r\n     * @param id {number}\r\n     * @returns {Promise<client>}\r\n     */},{key:\"getById\",value:function(){var _getById=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var url,reponse;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:url=\"/api/clients/\"+id;_context2.next=3;return this.dbal.get(url);case 3:reponse=_context2.sent;return _context2.abrupt(\"return\",new client(JSON.parse(reponse)));case 5:case\"end\":return _context2.stop();}}},_callee2,this);}));function getById(_x){return _getById.apply(this,arguments);}return getById;}()/**\r\n     * Récupère les données spécifiques d'un client\r\n     * @param c {Client}\r\n     * @returns {Promise<client>}\r\n     */},{key:\"load\",value:function(){var _load=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(c){var reponse;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this.dbal.get(c.ville);case 2:reponse=_context3.sent;c.ville=JSON.parse(reponse).nom;_context3.next=6;return this.dbal.get(\"/api/client/soldeById/\"+c.id);case 6:reponse=_context3.sent;c.solde=JSON.parse(reponse);return _context3.abrupt(\"return\",new client(c));case 9:case\"end\":return _context3.stop();}}},_callee3,this);}));function load(_x2){return _load.apply(this,arguments);}return load;}()/**\r\n     * Archive un client\r\n     * @param client {Client}\r\n     * @param valeur {string}\r\n     * @returns {Promise<string>}\r\n     */},{key:\"archiver\",value:function(){var _archiver=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(client,valeur){var url,params;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:url=\"/api/clients/modifclient\";params='{\"id\":\"'+client.id+'\",\"nom\":\"'+client.nom+'\",\"prenom\":\"'+client.prenom+'\",\"ville\":\"'+client.ville+'\",\"tel\":\"'+client.tel+'\",\"mail\":\"'+client.mail+'\",\"archive\":\"'+valeur+'\"}';_context4.next=4;return this.dbal.put(url,params);case 4:return _context4.abrupt(\"return\",_context4.sent);case 5:case\"end\":return _context4.stop();}}},_callee4,this);}));function archiver(_x3,_x4){return _archiver.apply(this,arguments);}return archiver;}()/**\r\n     * Modifie un client\r\n     * @param client {Client}\r\n     * @returns {Promise<string>}\r\n     */},{key:\"modifier\",value:function(){var _modifier=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(client){var archive,url,params;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:archive=!client.archive?\"0\":\"1\";url=\"/api/clients/modifclient\";params='{\"id\":\"'+client.id+'\",\"nom\":\"'+client.nom+'\",\"prenom\":\"'+client.prenom+'\",\"ville\":\"'+client.ville+'\",\"tel\":\"'+client.tel+'\",\"mail\":\"'+client.mail+'\",\"archive\":\"'+archive+'\"}';_context5.next=5;return this.dbal.put(url,params);case 5:return _context5.abrupt(\"return\",_context5.sent);case 6:case\"end\":return _context5.stop();}}},_callee5,this);}));function modifier(_x5){return _modifier.apply(this,arguments);}return modifier;}()/**\r\n     * Crée un client\r\n     * @param client {Client}\r\n     * @returns {Promise<client>}\r\n     */},{key:\"creer\",value:function(){var _creer=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(client){var url,params,reponse,lastId;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:url=\"/api/clients/addClient\";params='{\"id\":\"'+client.id+'\",\"nom\":\"'+client.nom+'\",\"prenom\":\"'+client.prenom+'\",\"ville\":\"'+client.ville+'\",\"tel\":\"'+client.tel+'\",\"mail\":\"'+client.mail+'\",\"archive\":\"0\"}';_context6.next=4;return this.dbal.post(url,params);case 4:reponse=_context6.sent;lastId=JSON.parse(reponse);_context6.next=8;return this.getById(lastId);case 8:client=_context6.sent;new DaoTransaction().initialiser(client);new DaoUtilisateur().addUser(client);_context6.next=13;return this.load(client);case 13:return _context6.abrupt(\"return\",_context6.sent);case 14:case\"end\":return _context6.stop();}}},_callee6,this);}));function creer(_x6){return _creer.apply(this,arguments);}return creer;}()}]);return DaoClient;}();export{DaoClient as default};","map":{"version":3,"sources":["C:/xampp/htdocs/DeuxiemeSituation/backend/src/modele/DaoClient.js"],"names":["Dbal","client","DaoTransaction","DaoUtilisateur","DaoClient","instance","dbal","liste","get","reponse","clients","JSON","parse","c","push","id","url","ville","nom","solde","valeur","params","prenom","tel","mail","put","archive","post","lastId","getById","initialiser","addUser","load"],"mappings":"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","sourcesContent":["import Dbal from \"./Dbal\";\r\nimport client from \"../metier/Client\";\r\nimport DaoTransaction from \"./DaoTransaction\";\r\nimport DaoUtilisateur from \"./DaoUtilisateur\";\r\n\r\nexport default class DaoClient {\r\n    /**\r\n     * Singleon\r\n     * @returns {DaoClient|DaoClient}\r\n     */\r\n    constructor() {\r\n        if (!!DaoClient.instance) {\r\n            return DaoClient.instance;\r\n        }\r\n        /**@type {DaoClient}**/\r\n        DaoClient.instance = this;\r\n        /**@type {Dbal}**/\r\n        this.dbal = new Dbal();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Récupère tous les clients\r\n     * @returns {Promise<[]>}\r\n     */\r\n    async getAll(){\r\n        const liste =  [];\r\n        const reponse = await this.dbal.get(\"/api/clients\");\r\n        const clients = JSON.parse(reponse);\r\n        for (const c of clients) {\r\n            liste.push(new client(c));\r\n        }\r\n        return liste;\r\n    }\r\n\r\n    /**\r\n     * Récupère un client à partir de sn Id\r\n     * @param id {number}\r\n     * @returns {Promise<client>}\r\n     */\r\n    async getById(id){\r\n        const url = \"/api/clients/\" + id;\r\n        const reponse = await this.dbal.get(url);\r\n        return new client(JSON.parse(reponse));\r\n    }\r\n\r\n    /**\r\n     * Récupère les données spécifiques d'un client\r\n     * @param c {Client}\r\n     * @returns {Promise<client>}\r\n     */\r\n    async load(c){\r\n        let reponse = await this.dbal.get(c.ville);\r\n        c.ville = (JSON.parse(reponse)).nom;\r\n        reponse = await this.dbal.get(\"/api/client/soldeById/\" + c.id);\r\n        c.solde = JSON.parse(reponse);\r\n        return new client(c);\r\n    }\r\n\r\n    /**\r\n     * Archive un client\r\n     * @param client {Client}\r\n     * @param valeur {string}\r\n     * @returns {Promise<string>}\r\n     */\r\n    async archiver(client, valeur){\r\n        const url = \"/api/clients/modifclient\";\r\n        const params = '{\"id\":\"'+client.id+'\",\"nom\":\"'+client.nom+'\",\"prenom\":\"'+client.prenom+'\",\"ville\":\"'+client.ville+'\",\"tel\":\"'+client.tel+'\",\"mail\":\"'+client.mail+'\",\"archive\":\"'+valeur+'\"}';\r\n        return await this.dbal.put(url, params);\r\n    }\r\n\r\n    /**\r\n     * Modifie un client\r\n     * @param client {Client}\r\n     * @returns {Promise<string>}\r\n     */\r\n    async modifier(client){\r\n        const archive = (!client.archive)?\"0\":\"1\";\r\n        const url = \"/api/clients/modifclient\";\r\n        const params = '{\"id\":\"'+client.id+'\",\"nom\":\"'+client.nom+'\",\"prenom\":\"'+client.prenom+'\",\"ville\":\"'+client.ville+'\",\"tel\":\"'+client.tel+'\",\"mail\":\"'+client.mail+'\",\"archive\":\"'+archive+'\"}';\r\n        return await this.dbal.put(url, params);\r\n    }\r\n\r\n    /**\r\n     * Crée un client\r\n     * @param client {Client}\r\n     * @returns {Promise<client>}\r\n     */\r\n    async creer(client){\r\n        let url = \"/api/clients/addClient\";\r\n        const params = '{\"id\":\"'+client.id+'\",\"nom\":\"'+client.nom+'\",\"prenom\":\"'+client.prenom+'\",\"ville\":\"'+client.ville+'\",\"tel\":\"'+client.tel+'\",\"mail\":\"'+client.mail+'\",\"archive\":\"0\"}';\r\n        let reponse = await this.dbal.post(url, params);\r\n        const lastId = JSON.parse(reponse);\r\n        client = await this.getById(lastId);\r\n\r\n        new DaoTransaction().initialiser(client);\r\n        new DaoUtilisateur().addUser(client);\r\n        return await this.load(client);\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}