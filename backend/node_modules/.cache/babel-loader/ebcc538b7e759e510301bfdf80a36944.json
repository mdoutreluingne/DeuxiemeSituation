{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\xampp\\\\htdocs\\\\DeuxiemeSituation\\\\backend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import client from\"../metier/Client\";import DaoClient from\"../modele/DaoClient\";import DaoVille from\"../modele/DaoVille\";/**\r\n * Composant qui affiche le client\r\n */var InfosClient=/*#__PURE__*/function(_React$Component){_inherits(InfosClient,_React$Component);function InfosClient(props){var _this;_classCallCheck(this,InfosClient);_this=_possibleConstructorReturn(this,_getPrototypeOf(InfosClient).call(this,props));_this.state={/**@type {number}**/update:0,/**@type {DaoClient}**/daoClient:new DaoClient(),/**@type {Client}**/client:new client(null),/**@type {[Client]}**/listeClients:props.clients,/**@type {[Ville]}**/listeVilles:[]};return _this;}/**\r\n     * Force la mise à jour de la page\r\n     */_createClass(InfosClient,[{key:\"update\",value:function update(){this.setState({update:this.state.update+1});}/**\r\n     * Change une info du client\r\n     * @param propriete {string}\r\n     * @param event\r\n     * @returns {Promise<void>}\r\n     */},{key:\"change\",value:function(){var _change=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(propriete,event){var client,villes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:client=this.state.client;client[propriete]=event.target.value;if(!(propriete===\"ville\"&&event.target.value.length>=4)){_context.next=11;break;}document.body.style.cursor='progress';_context.next=6;return new DaoVille().getVilleByNom(event.target.value);case 6:villes=_context.sent;document.body.style.cursor='default';this.setState({listeVilles:villes,client:client});_context.next=12;break;case 11:this.setState({listeVilles:[],client:client});case 12:this.props.onChange(client);case 13:case\"end\":return _context.stop();}}},_callee,this);}));function change(_x,_x2){return _change.apply(this,arguments);}return change;}()/**\r\n     * Séléctionne un client\r\n     * @param event\r\n     */},{key:\"selectClient\",value:function selectClient(event){var _this2=this;var self=this;if(event.nativeEvent.data===undefined){var options=Array.from(event.target.list.children);options.forEach(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(option){var c;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(option.value===event.target.value)){_context2.next=6;break;}_context2.next=3;return self.loadClient(JSON.parse(option.dataset.client));case 3:c=_context2.sent;_this2.setState({client:c});_this2.props.onChange(c);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref.apply(this,arguments);};}());//Ou si l'on change son nom\n}else{var _client=this.state.client;_client.nom=event.target.value;this.setState({client:_client});this.props.onChange(_client);}}/**\r\n     * Charge les infos d'un client\r\n     * @param c {Client}\r\n     * @returns {Promise<client>}\r\n     */},{key:\"loadClient\",value:function(){var _loadClient=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(c){var result;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:document.body.style.cursor='progress';_context3.next=3;return this.state.daoClient.load(c);case 3:result=_context3.sent;document.body.style.cursor='default';return _context3.abrupt(\"return\",result);case 6:case\"end\":return _context3.stop();}}},_callee3,this);}));function loadClient(_x4){return _loadClient.apply(this,arguments);}return loadClient;}()/**\r\n     * Reset les infos du client\r\n     */},{key:\"reset\",value:function reset(){var c=new client(null);this.setState({client:c});this.props.onChange(c);}/**\r\n     * Archive le client séléctionné\r\n     * @param archive {string}\r\n     * @returns {Promise<void>}\r\n     */},{key:\"archiver\",value:function(){var _archiver=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(archive){var client;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:client=this.state.client;client.archive=archive!==\"0\";document.body.style.cursor='progress';_context4.next=5;return this.state.daoClient.archiver(client,archive);case 5:document.body.style.cursor='default';this.setState({client:client});case 7:case\"end\":return _context4.stop();}}},_callee4,this);}));function archiver(_x5){return _archiver.apply(this,arguments);}return archiver;}()/**\r\n     * Modifie le client\r\n     * @returns {Promise<void>}\r\n     */},{key:\"modifier\",value:function(){var _modifier=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!(this.state.client.nom!==\"\"&&this.state.client.prenom!==\"\")){_context5.next=9;break;}document.body.style.cursor='progress';_context5.next=4;return this.state.daoClient.modifier(this.state.client);case 4:alert(\"Le client a été modifié\");document.body.style.cursor='default';this.update();_context5.next=10;break;case 9:alert(\"Le nom et le prénom ne peuvent pas être vide\");case 10:case\"end\":return _context5.stop();}}},_callee5,this);}));function modifier(){return _modifier.apply(this,arguments);}return modifier;}()/**\r\n     * Crée un nouveau client\r\n     * @returns {Promise<void>}\r\n     */},{key:\"creer\",value:function(){var _creer=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var client;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return this.state.daoClient.creer(this.state.client);case 2:client=_context6.sent;if(client.nom!==\"\"&&client.prenom!==\"\"){document.body.style.cursor='progress';document.body.style.cursor='default';alert(\"Le client a été crée\");this.setState({client:client});this.props.onChange(client);}else{alert(\"Merci de renseigner les champs obligatoires\");}case 4:case\"end\":return _context6.stop();}}},_callee6,this);}));function creer(){return _creer.apply(this,arguments);}return creer;}()/**\r\n     * Affiche les boutons d'actions\r\n     * @returns {*}\r\n     */},{key:\"afficherActions\",value:function afficherActions(){if(this.state.client.id!==0&&!this.state.client.archive){return React.createElement(\"section\",{className:\"actions\"},React.createElement(\"button\",{className:\"editer\",onClick:this.modifier.bind(this)},\"MODIFIER\"),React.createElement(\"button\",{className:\"archiver\",onClick:this.archiver.bind(this,\"1\")},\"ARCHIVER\"),React.createElement(\"button\",{className:\"nouveau\",onClick:this.reset.bind(this)},\"NOUVEAU\"));}else if(this.state.client.id!==0){return React.createElement(\"section\",{className:\"actions\"},React.createElement(\"button\",{className:\"editer\",onClick:this.modifier.bind(this)},\"MODIFIER\"),React.createElement(\"button\",{className:\"desarchiver\",onClick:this.archiver.bind(this,\"0\")},\"DESARCHIVER\"),React.createElement(\"button\",{className:\"nouveau\",onClick:this.reset.bind(this)},\"NOUVEAU\"));}else{return React.createElement(\"section\",{className:\"actions\"},React.createElement(\"button\",{className:\"editer\",onClick:this.creer.bind(this)},\"CREER\"),React.createElement(\"button\",{className:\"archiver\",disabled:true},\"ARCHIVER\"));}}},{key:\"render\",value:function render(){var client=this.state.client;return React.createElement(\"section\",{className:\"selectionClient\"},React.createElement(\"section\",{className:\"client\"},React.createElement(\"h2\",{className:\"title\"},\"CLIENTS\"),React.createElement(\"div\",{className:\"saisie\"},React.createElement(\"legend\",{className:\"description\"},\"NOM\"),React.createElement(\"input\",{className:\"zone prenom\",type:\"text\",list:\"listeClient\",value:client.nom,onChange:this.selectClient.bind(this)}),React.createElement(\"datalist\",{id:\"listeClient\"},this.state.listeClients.map(function(client,index){return React.createElement(\"option\",{key:index,\"data-client\":JSON.stringify(client)},client.nom+\" \"+client.prenom);}))),React.createElement(\"div\",{className:\"saisie\"},React.createElement(\"legend\",{className:\"description\"},\"PRENOM\"),React.createElement(\"input\",{className:\"zone prenom\",type:\"text\",value:client.prenom,onChange:this.change.bind(this,\"prenom\")})),React.createElement(\"div\",{className:\"saisie\"},React.createElement(\"legend\",{className:\"description\"},\"VILLE\"),React.createElement(\"input\",{className:\"zone ville\",type:\"text\",list:\"listeVille\",value:client.ville,onChange:this.change.bind(this,\"ville\")}),React.createElement(\"datalist\",{id:\"listeVille\"},this.state.listeVilles.map(function(ville,index){return React.createElement(\"option\",{key:index,\"data-client\":JSON.stringify(ville)},ville.nom);}))),React.createElement(\"div\",{className:\"saisie\"},React.createElement(\"legend\",{className:\"description\"},\"E-MAIL\"),React.createElement(\"input\",{className:\"zone mail\",type:\"text\",value:client.mail,onChange:this.change.bind(this,\"mail\")})),React.createElement(\"div\",{className:\"saisie\"},React.createElement(\"legend\",{className:\"description\"},\"TELEPHONE\"),React.createElement(\"input\",{className:\"zone telephone\",type:\"text\",value:client.tel,onChange:this.change.bind(this,\"tel\")})),React.createElement(\"div\",{className:\"saisie\"},React.createElement(\"legend\",{className:\"description\"},\"SOLDE\"),React.createElement(\"input\",{className:\"zone solde\",type:\"text\",value:client.solde,disabled:true})),this.afficherActions()));}}]);return InfosClient;}(React.Component);export default InfosClient;","map":{"version":3,"sources":["C:/xampp/htdocs/DeuxiemeSituation/backend/src/components/InfosClient.js"],"names":["React","client","DaoClient","DaoVille","InfosClient","props","state","update","daoClient","listeClients","clients","listeVilles","setState","propriete","event","target","value","length","document","body","style","cursor","getVilleByNom","villes","onChange","self","nativeEvent","data","undefined","options","Array","from","list","children","forEach","option","loadClient","JSON","parse","dataset","c","nom","load","result","archive","archiver","prenom","modifier","alert","creer","id","bind","reset","selectClient","map","index","stringify","change","ville","mail","tel","solde","afficherActions","Component"],"mappings":"g6BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,kBAAnB,CACA,MAAOC,CAAAA,SAAP,KAAsB,qBAAtB,CACA,MAAOC,CAAAA,QAAP,KAAqB,oBAArB,CAEA;;MAGMC,CAAAA,W,iFACF,qBAAYC,KAAZ,CAAmB,6CACf,6EAAMA,KAAN,GACA,MAAKC,KAAL,CAAa,CACT,oBACAC,MAAM,CAAE,CAFC,CAGT,uBACAC,SAAS,CAAE,GAAIN,CAAAA,SAAJ,EAJF,CAKT,oBACAD,MAAM,CAAE,GAAIA,CAAAA,MAAJ,CAAW,IAAX,CANC,CAOT,sBACAQ,YAAY,CAAEJ,KAAK,CAACK,OARX,CAST,qBACAC,WAAW,CAAE,EAVJ,CAAb,CAFe,aAclB,CAED;;sEAGS,CACL,KAAKC,QAAL,CAAc,CACVL,MAAM,CAAE,KAAKD,KAAL,CAAWC,MAAX,CAAoB,CADlB,CAAd,EAGH,CAED;;;;;6HAMaM,S,CAAWC,K,oIACdb,M,CAAS,KAAKK,KAAL,CAAWL,M,CAC1BA,MAAM,CAACY,SAAD,CAAN,CAAoBC,KAAK,CAACC,MAAN,CAAaC,KAAjC,C,KAEIH,SAAS,GAAK,OAAd,EAAyBC,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBC,MAAnB,EAA6B,C,2BACtDC,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA6B,UAA7B,C,sBACqB,IAAIlB,CAAAA,QAAJ,GAAemB,aAAf,CAA6BR,KAAK,CAACC,MAAN,CAAaC,KAA1C,C,QAAfO,M,eACNL,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA6B,SAA7B,CACA,KAAKT,QAAL,CAAc,CACVD,WAAW,CAAEY,MADH,CAEVtB,MAAM,CAAEA,MAFE,CAAd,E,+BAKA,KAAKW,QAAL,CAAc,CACVD,WAAW,CAAE,EADH,CAEVV,MAAM,CAAEA,MAFE,CAAd,E,QAKJ,KAAKI,KAAL,CAAWmB,QAAX,CAAoBvB,MAApB,E,8IAGJ;;;yDAIaa,K,CAAO,iBAChB,GAAMW,CAAAA,IAAI,CAAG,IAAb,CACA,GAAIX,KAAK,CAACY,WAAN,CAAkBC,IAAlB,GAA2BC,SAA/B,CAA0C,CACtC,GAAMC,CAAAA,OAAO,CAAGC,KAAK,CAACC,IAAN,CAAWjB,KAAK,CAACC,MAAN,CAAaiB,IAAb,CAAkBC,QAA7B,CAAhB,CACAJ,OAAO,CAACK,OAAR,0FAAgB,kBAAOC,MAAP,iIACRA,MAAM,CAACnB,KAAP,GAAiBF,KAAK,CAACC,MAAN,CAAaC,KADtB,kDAESS,CAAAA,IAAI,CAACW,UAAL,CAAgBC,IAAI,CAACC,KAAL,CAAWH,MAAM,CAACI,OAAP,CAAetC,MAA1B,CAAhB,CAFT,QAEFuC,CAFE,gBAGR,MAAI,CAAC5B,QAAL,CAAc,CAACX,MAAM,CAAEuC,CAAT,CAAd,EACA,MAAI,CAACnC,KAAL,CAAWmB,QAAX,CAAoBgB,CAApB,EAJQ,wDAAhB,iEAOJ;AACC,CAVD,IAUO,CACH,GAAMvC,CAAAA,OAAM,CAAG,KAAKK,KAAL,CAAWL,MAA1B,CACAA,OAAM,CAACwC,GAAP,CAAa3B,KAAK,CAACC,MAAN,CAAaC,KAA1B,CACA,KAAKJ,QAAL,CAAc,CACVX,MAAM,CAAEA,OADE,CAAd,EAGA,KAAKI,KAAL,CAAWmB,QAAX,CAAoBvB,OAApB,EACH,CACJ,CAED;;;;sIAKiBuC,C,iIACbtB,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA6B,UAA7B,C,uBACqB,MAAKf,KAAL,CAAWE,SAAX,CAAqBkC,IAArB,CAA0BF,CAA1B,C,QAAfG,M,gBACNzB,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA6B,SAA7B,C,iCACOsB,M,0JAGX;;4CAGQ,CACJ,GAAMH,CAAAA,CAAC,CAAG,GAAIvC,CAAAA,MAAJ,CAAW,IAAX,CAAV,CACA,KAAKW,QAAL,CAAc,CAACX,MAAM,CAAEuC,CAAT,CAAd,EACA,KAAKnC,KAAL,CAAWmB,QAAX,CAAoBgB,CAApB,EACH,CAED;;;;kIAKeI,O,iIACL3C,M,CAAS,KAAKK,KAAL,CAAWL,M,CAC1BA,MAAM,CAAC2C,OAAP,CAAkBA,OAAO,GAAK,GAA9B,CACA1B,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA6B,UAA7B,C,uBACM,MAAKf,KAAL,CAAWE,SAAX,CAAqBqC,QAArB,CAA8B5C,MAA9B,CAAsC2C,OAAtC,C,QACN1B,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA6B,SAA7B,CACA,KAAKT,QAAL,CAAc,CACVX,MAAM,CAAEA,MADE,CAAd,E,kJAKJ;;;6PAKQ,KAAKK,KAAL,CAAWL,MAAX,CAAkBwC,GAAlB,GAA0B,EAA1B,EAAgC,KAAKnC,KAAL,CAAWL,MAAX,CAAkB6C,MAAlB,GAA6B,E,2BAC7D5B,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA6B,UAA7B,C,uBACM,MAAKf,KAAL,CAAWE,SAAX,CAAqBuC,QAArB,CAA8B,KAAKzC,KAAL,CAAWL,MAAzC,C,QACN+C,KAAK,CAAC,yBAAD,CAAL,CACA9B,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA6B,SAA7B,CACA,KAAKd,MAAL,G,+BAEAyC,KAAK,CAAC,8CAAD,CAAL,C,gJAIR;;;oRAKyB,MAAK1C,KAAL,CAAWE,SAAX,CAAqByC,KAArB,CAA2B,KAAK3C,KAAL,CAAWL,MAAtC,C,QAAfA,M,gBACN,GAAIA,MAAM,CAACwC,GAAP,GAAe,EAAf,EAAqBxC,MAAM,CAAC6C,MAAP,GAAkB,EAA3C,CAA8C,CAC1C5B,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA6B,UAA7B,CACAH,QAAQ,CAACC,IAAT,CAAcC,KAAd,CAAoBC,MAApB,CAA6B,SAA7B,CACA2B,KAAK,CAAC,sBAAD,CAAL,CACA,KAAKpC,QAAL,CAAc,CAACX,MAAM,CAAEA,MAAT,CAAd,EACA,KAAKI,KAAL,CAAWmB,QAAX,CAAoBvB,MAApB,EACH,CAND,IAMO,CACH+C,KAAK,CAAC,6CAAD,CAAL,CACH,C,sIAGL;;;gEAIkB,CACd,GAAI,KAAK1C,KAAL,CAAWL,MAAX,CAAkBiD,EAAlB,GAAyB,CAAzB,EAA8B,CAAC,KAAK5C,KAAL,CAAWL,MAAX,CAAkB2C,OAArD,CAA8D,CAC1D,MACI,gCAAS,SAAS,CAAC,SAAnB,EACI,8BAAQ,SAAS,CAAC,QAAlB,CAA2B,OAAO,CAAE,KAAKG,QAAL,CAAcI,IAAd,CAAmB,IAAnB,CAApC,aADJ,CAEI,8BAAQ,SAAS,CAAC,UAAlB,CAA6B,OAAO,CAAE,KAAKN,QAAL,CAAcM,IAAd,CAAmB,IAAnB,CAAwB,GAAxB,CAAtC,aAFJ,CAGI,8BAAQ,SAAS,CAAC,SAAlB,CAA4B,OAAO,CAAE,KAAKC,KAAL,CAAWD,IAAX,CAAgB,IAAhB,CAArC,YAHJ,CADJ,CAOH,CARD,IAQO,IAAI,KAAK7C,KAAL,CAAWL,MAAX,CAAkBiD,EAAlB,GAAyB,CAA7B,CAAgC,CACnC,MACI,gCAAS,SAAS,CAAC,SAAnB,EACI,8BAAQ,SAAS,CAAC,QAAlB,CAA2B,OAAO,CAAE,KAAKH,QAAL,CAAcI,IAAd,CAAmB,IAAnB,CAApC,aADJ,CAEI,8BAAQ,SAAS,CAAC,aAAlB,CAAgC,OAAO,CAAE,KAAKN,QAAL,CAAcM,IAAd,CAAmB,IAAnB,CAAwB,GAAxB,CAAzC,gBAFJ,CAGI,8BAAQ,SAAS,CAAC,SAAlB,CAA4B,OAAO,CAAE,KAAKC,KAAL,CAAWD,IAAX,CAAgB,IAAhB,CAArC,YAHJ,CADJ,CAOH,CARM,IAQA,CACH,MACI,gCAAS,SAAS,CAAC,SAAnB,EACI,8BAAQ,SAAS,CAAC,QAAlB,CAA2B,OAAO,CAAE,KAAKF,KAAL,CAAWE,IAAX,CAAgB,IAAhB,CAApC,UADJ,CAEI,8BAAQ,SAAS,CAAC,UAAlB,CAA6B,QAAQ,KAArC,aAFJ,CADJ,CAMH,CACJ,C,uCAEQ,CACL,GAAMlD,CAAAA,MAAM,CAAG,KAAKK,KAAL,CAAWL,MAA1B,CACA,MACI,gCAAS,SAAS,CAAC,iBAAnB,EACI,+BAAS,SAAS,CAAC,QAAnB,EACI,0BAAI,SAAS,CAAC,OAAd,YADJ,CAEI,2BAAK,SAAS,CAAC,QAAf,EACI,8BAAQ,SAAS,CAAC,aAAlB,QADJ,CAEI,6BAAO,SAAS,CAAC,aAAjB,CAA+B,IAAI,CAAC,MAApC,CAA2C,IAAI,CAAC,aAAhD,CAA8D,KAAK,CAAEA,MAAM,CAACwC,GAA5E,CACO,QAAQ,CAAE,KAAKY,YAAL,CAAkBF,IAAlB,CAAuB,IAAvB,CADjB,EAFJ,CAII,gCAAU,EAAE,CAAC,aAAb,EACK,KAAK7C,KAAL,CAAWG,YAAX,CAAwB6C,GAAxB,CAA4B,SAACrD,MAAD,CAASsD,KAAT,CAAmB,CAC5C,MACI,+BAAQ,GAAG,CAAEA,KAAb,CACQ,cAAalB,IAAI,CAACmB,SAAL,CAAevD,MAAf,CADrB,EAC8CA,MAAM,CAACwC,GAAP,CAAa,GAAb,CAAoBxC,MAAM,CAAC6C,MADzE,CADJ,CAIH,CALA,CADL,CAJJ,CAFJ,CAeI,2BAAK,SAAS,CAAC,QAAf,EACI,8BAAQ,SAAS,CAAC,aAAlB,WADJ,CAEI,6BAAO,SAAS,CAAC,aAAjB,CAA+B,IAAI,CAAC,MAApC,CAA2C,KAAK,CAAE7C,MAAM,CAAC6C,MAAzD,CACO,QAAQ,CAAE,KAAKW,MAAL,CAAYN,IAAZ,CAAiB,IAAjB,CAAuB,QAAvB,CADjB,EAFJ,CAfJ,CAoBI,2BAAK,SAAS,CAAC,QAAf,EACI,8BAAQ,SAAS,CAAC,aAAlB,UADJ,CAEI,6BAAO,SAAS,CAAC,YAAjB,CAA8B,IAAI,CAAC,MAAnC,CAA0C,IAAI,CAAC,YAA/C,CAA4D,KAAK,CAAElD,MAAM,CAACyD,KAA1E,CACO,QAAQ,CAAE,KAAKD,MAAL,CAAYN,IAAZ,CAAiB,IAAjB,CAAuB,OAAvB,CADjB,EAFJ,CAII,gCAAU,EAAE,CAAC,YAAb,EACK,KAAK7C,KAAL,CAAWK,WAAX,CAAuB2C,GAAvB,CAA2B,SAACI,KAAD,CAAQH,KAAR,CAAkB,CAC1C,MACI,+BAAQ,GAAG,CAAEA,KAAb,CACQ,cAAalB,IAAI,CAACmB,SAAL,CAAeE,KAAf,CADrB,EAC6CA,KAAK,CAACjB,GADnD,CADJ,CAIH,CALA,CADL,CAJJ,CApBJ,CAiCI,2BAAK,SAAS,CAAC,QAAf,EACI,8BAAQ,SAAS,CAAC,aAAlB,WADJ,CAEI,6BAAO,SAAS,CAAC,WAAjB,CAA6B,IAAI,CAAC,MAAlC,CAAyC,KAAK,CAAExC,MAAM,CAAC0D,IAAvD,CACO,QAAQ,CAAE,KAAKF,MAAL,CAAYN,IAAZ,CAAiB,IAAjB,CAAuB,MAAvB,CADjB,EAFJ,CAjCJ,CAsCI,2BAAK,SAAS,CAAC,QAAf,EACI,8BAAQ,SAAS,CAAC,aAAlB,cADJ,CAEI,6BAAO,SAAS,CAAC,gBAAjB,CAAkC,IAAI,CAAC,MAAvC,CAA8C,KAAK,CAAElD,MAAM,CAAC2D,GAA5D,CACO,QAAQ,CAAE,KAAKH,MAAL,CAAYN,IAAZ,CAAiB,IAAjB,CAAuB,KAAvB,CADjB,EAFJ,CAtCJ,CA2CI,2BAAK,SAAS,CAAC,QAAf,EACI,8BAAQ,SAAS,CAAC,aAAlB,UADJ,CAEI,6BAAO,SAAS,CAAC,YAAjB,CAA8B,IAAI,CAAC,MAAnC,CAA0C,KAAK,CAAElD,MAAM,CAAC4D,KAAxD,CAA+D,QAAQ,KAAvE,EAFJ,CA3CJ,CA+CK,KAAKC,eAAL,EA/CL,CADJ,CADJ,CAqDH,C,yBA3OqB9D,KAAK,CAAC+D,S,EA8OhC,cAAe3D,CAAAA,WAAf","sourcesContent":["import React from 'react';\r\nimport client from \"../metier/Client\";\r\nimport DaoClient from \"../modele/DaoClient\";\r\nimport DaoVille from \"../modele/DaoVille\";\r\n\r\n/**\r\n * Composant qui affiche le client\r\n */\r\nclass InfosClient extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            /**@type {number}**/\r\n            update: 0,\r\n            /**@type {DaoClient}**/\r\n            daoClient: new DaoClient(),\r\n            /**@type {Client}**/\r\n            client: new client(null),\r\n            /**@type {[Client]}**/\r\n            listeClients: props.clients,\r\n            /**@type {[Ville]}**/\r\n            listeVilles: [],\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Force la mise à jour de la page\r\n     */\r\n    update() {\r\n        this.setState({\r\n            update: this.state.update + 1\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Change une info du client\r\n     * @param propriete {string}\r\n     * @param event\r\n     * @returns {Promise<void>}\r\n     */\r\n    async change(propriete, event) {\r\n        const client = this.state.client;\r\n        client[propriete] = event.target.value;\r\n\r\n        if (propriete === \"ville\" && event.target.value.length >= 4){\r\n            document.body.style.cursor = 'progress';\r\n            const villes = await new DaoVille().getVilleByNom(event.target.value);\r\n            document.body.style.cursor = 'default';\r\n            this.setState({\r\n                listeVilles: villes,\r\n                client: client\r\n            });\r\n        } else {\r\n            this.setState({\r\n                listeVilles: [],\r\n                client: client\r\n            });\r\n        }\r\n        this.props.onChange(client);\r\n    }\r\n\r\n    /**\r\n     * Séléctionne un client\r\n     * @param event\r\n     */\r\n    selectClient(event) {\r\n        const self = this;\r\n        if (event.nativeEvent.data === undefined) {\r\n            const options = Array.from(event.target.list.children);\r\n            options.forEach(async (option) => {\r\n                if (option.value === event.target.value) {\r\n                    const c =  await self.loadClient(JSON.parse(option.dataset.client));\r\n                    this.setState({client: c});\r\n                    this.props.onChange(c);\r\n                }\r\n            });\r\n        //Ou si l'on change son nom\r\n        } else {\r\n            const client = this.state.client;\r\n            client.nom = event.target.value;\r\n            this.setState({\r\n                client: client\r\n            });\r\n            this.props.onChange(client);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Charge les infos d'un client\r\n     * @param c {Client}\r\n     * @returns {Promise<client>}\r\n     */\r\n    async loadClient(c){\r\n        document.body.style.cursor = 'progress';\r\n        const result = await this.state.daoClient.load(c);\r\n        document.body.style.cursor = 'default';\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Reset les infos du client\r\n     */\r\n    reset() {\r\n        const c = new client(null);\r\n        this.setState({client: c});\r\n        this.props.onChange(c);\r\n    }\r\n\r\n    /**\r\n     * Archive le client séléctionné\r\n     * @param archive {string}\r\n     * @returns {Promise<void>}\r\n     */\r\n    async archiver(archive){\r\n        const client = this.state.client;\r\n        client.archive = (archive !== \"0\");\r\n        document.body.style.cursor = 'progress';\r\n        await this.state.daoClient.archiver(client, archive);\r\n        document.body.style.cursor = 'default';\r\n        this.setState({\r\n            client: client\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Modifie le client\r\n     * @returns {Promise<void>}\r\n     */\r\n    async modifier(){\r\n        if (this.state.client.nom !== \"\" && this.state.client.prenom !== \"\"){\r\n            document.body.style.cursor = 'progress';\r\n            await this.state.daoClient.modifier(this.state.client);\r\n            alert(\"Le client a été modifié\");\r\n            document.body.style.cursor = 'default';\r\n            this.update();\r\n        } else {\r\n            alert(\"Le nom et le prénom ne peuvent pas être vide\")\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Crée un nouveau client\r\n     * @returns {Promise<void>}\r\n     */\r\n    async creer(){\r\n        const client = await this.state.daoClient.creer(this.state.client);\r\n        if (client.nom !== \"\" && client.prenom !== \"\"){\r\n            document.body.style.cursor = 'progress';\r\n            document.body.style.cursor = 'default';\r\n            alert(\"Le client a été crée\");\r\n            this.setState({client: client});\r\n            this.props.onChange(client);\r\n        } else {\r\n            alert(\"Merci de renseigner les champs obligatoires\")\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Affiche les boutons d'actions\r\n     * @returns {*}\r\n     */\r\n    afficherActions() {\r\n        if (this.state.client.id !== 0 && !this.state.client.archive) {\r\n            return (\r\n                <section className=\"actions\">\r\n                    <button className=\"editer\" onClick={this.modifier.bind(this)}>MODIFIER</button>\r\n                    <button className=\"archiver\" onClick={this.archiver.bind(this,\"1\")}>ARCHIVER</button>\r\n                    <button className=\"nouveau\" onClick={this.reset.bind(this)}>NOUVEAU</button>\r\n                </section>\r\n            )\r\n        } else if (this.state.client.id !== 0) {\r\n            return (\r\n                <section className=\"actions\">\r\n                    <button className=\"editer\" onClick={this.modifier.bind(this)}>MODIFIER</button>\r\n                    <button className=\"desarchiver\" onClick={this.archiver.bind(this,\"0\")}>DESARCHIVER</button>\r\n                    <button className=\"nouveau\" onClick={this.reset.bind(this)}>NOUVEAU</button>\r\n                </section>\r\n            )\r\n        } else {\r\n            return (\r\n                <section className=\"actions\">\r\n                    <button className=\"editer\" onClick={this.creer.bind(this)}>CREER</button>\r\n                    <button className=\"archiver\" disabled>ARCHIVER</button>\r\n                </section>\r\n            )\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const client = this.state.client;\r\n        return (\r\n            <section className=\"selectionClient\">\r\n                <section className=\"client\">\r\n                    <h2 className=\"title\">CLIENTS</h2>\r\n                    <div className=\"saisie\">\r\n                        <legend className=\"description\">NOM</legend>\r\n                        <input className=\"zone prenom\" type=\"text\" list=\"listeClient\" value={client.nom}\r\n                               onChange={this.selectClient.bind(this)}/>\r\n                        <datalist id=\"listeClient\">\r\n                            {this.state.listeClients.map((client, index) => {\r\n                                return (\r\n                                    <option key={index}\r\n                                            data-client={JSON.stringify(client)}>{client.nom + \" \" +  client.prenom}</option>\r\n                                )\r\n                            })}\r\n                        </datalist>\r\n                    </div>\r\n                    <div className=\"saisie\">\r\n                        <legend className=\"description\">PRENOM</legend>\r\n                        <input className=\"zone prenom\" type=\"text\" value={client.prenom}\r\n                               onChange={this.change.bind(this, \"prenom\")}/>\r\n                    </div>\r\n                    <div className=\"saisie\">\r\n                        <legend className=\"description\">VILLE</legend>\r\n                        <input className=\"zone ville\" type=\"text\" list=\"listeVille\" value={client.ville}\r\n                               onChange={this.change.bind(this, \"ville\")}/>\r\n                        <datalist id=\"listeVille\">\r\n                            {this.state.listeVilles.map((ville, index) => {\r\n                                return (\r\n                                    <option key={index}\r\n                                            data-client={JSON.stringify(ville)}>{ville.nom}</option>\r\n                                )\r\n                            })}\r\n                        </datalist>\r\n                    </div>\r\n                    <div className=\"saisie\">\r\n                        <legend className=\"description\">E-MAIL</legend>\r\n                        <input className=\"zone mail\" type=\"text\" value={client.mail}\r\n                               onChange={this.change.bind(this, \"mail\")}/>\r\n                    </div>\r\n                    <div className=\"saisie\">\r\n                        <legend className=\"description\">TELEPHONE</legend>\r\n                        <input className=\"zone telephone\" type=\"text\" value={client.tel}\r\n                               onChange={this.change.bind(this, \"tel\")}/>\r\n                    </div>\r\n                    <div className=\"saisie\">\r\n                        <legend className=\"description\">SOLDE</legend>\r\n                        <input className=\"zone solde\" type=\"text\" value={client.solde} disabled/>\r\n                    </div>\r\n                    {this.afficherActions()}\r\n                </section>\r\n            </section>\r\n        )\r\n    }\r\n}\r\n\r\nexport default InfosClient;"]},"metadata":{},"sourceType":"module"}